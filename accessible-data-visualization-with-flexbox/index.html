<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Accessible Data Visualization with Flexbox</title><meta name=description content=""><meta name=viewport content="width=device-width, initial-scale=1"><!-- Place favicon.ico and apple-touch-icon(s) in the root directory --><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css rel=stylesheet><link rel=stylesheet type=text/css href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Open+Sans:700,400"><link rel=stylesheet href=/css/main.23ea.css><script src=/js/head-scripts.a52a.js></script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header id=site-head><div class=vertical><div id=site-head-content class=inner><a id=blog-logo href="/"><img src="http://gravatar.com/avatar/821e34ba1be557547dd449463ddf4d24?s=600" alt="Blog Logo"></a><h1 class=blog-title>aboutaaron</h1><h2 class=blog-description>journalist and web developer</h2></div></div></header><div class=frame><div class=bit-50><article class=post><time>01 Feb 2014</time><h1 class=post-title>Accessible Data Visualization with Flexbox</h1><section class=post-content><p>In 2008, digital designer <a href="http://wilsonminer.com/">Wilson Miner</a> wrote an article for <strong>A List Apart</strong> called <a href=http://alistapart.com/article/accessibledatavisualization><strong>Accessbile Data Visualization with Web Standards</strong></a> where he discussed how to to create simple, accessible data visualizations using HTML/CSS and not Flash. I found his approach powerful and simple as it leveraged tools many developers already know and doesn&#39;t introduce another tool, e.g. d3.js or Raphael.js, into what could be an already complicated application.</p><p>Indeed, organizations like ProPublica have used Miner&#39;s technique in many of their data-driven interactive investigations (thanks to <a href=https://twitter.com/thejefflarson>Jeff Larson</a> for showing me Miner&#39;s original article). For example, their <a href="http://projects.propublica.org/emails/"><strong>Message Machine</strong></a> app renders HTML bars with relevant <strong>data-uri</strong>s that contain data for each campaign email. These bars in total create a timeline of events within a fixed container:</p><p><img src=/img/messagemachine.14f1.png alt="A screenshot of ProPublica&#39;s message machine app"></p><p>After seeing this, I was inspired to build an interactive like this without using the industry go-to d3.js. I love Miner&#39;s article, but it was written several years ago so it doesn&#39;t offer, I think, the most up-to-date approach to creating a flexible, HTML- and CSS-based chart.</p><p>For one Flash, isn&#39;t the tool for data viz these days &mdash; JavaScript is. It&#39;s arguable that they&#39;re both inaccessbile for data viz, but JavaScript support is pretty solid in modern browsers (Firefox doesn&#39;t even let you turn it off unless you&#39;re in developer mode) so I&#39;m going to assume we can build for users with it enabled.</p><p>Secondly, his article doesn&#39;t use any new CSS3 properties for styling bars, nor does it consider using responsive web design for mobile users. Luckily, a new-ish CSS spec can solve some of these headaches: <strong>flexbox</strong>.</p><h3>Flex box</h3><p><strong>NOTE:</strong> There are two <code>flexbox</code> specs: an older, 2009 version and the current one. This article refers to the most recent iteration of the spec. Refer to this <a href="http://css-tricks.com/old-flexbox-and-new-flexbox/">CSS-Tricks article</a> to learn the difference between the two specifications and also check out W3C&#39;s <a href="http://www.w3.org/TR/css3-flexbox/">official documentation</a> on it.</p><p>While flexbox has <a href=http://caniuse.com/flexbox>decent <strong>modern</strong> browser support</a>, it is still kind of bleeding edge so consider your audience when using this technique and make sure you have a fallback.</p><h4>How it works</h4><p>While I could probably try to explain <code>flexbox</code>, Sean Fioritto at <strong>Sketching with CSS</strong> does a much better job (it&#39;s how I learned about it). First, watch his <a href="http://www.sketchingwithcss.com/flexbox-tutorial/">interactive video tutorial</a> and then view his handy <a href=http://www.sketchingwithcss.com/samplechapter/cheatsheet.html>cheatsheet</a>.</p><p>The basic idea is that the browser, given a flexbox-enabled container, will adjust the width of its children elements to always fit inside the container. For example take this HTML from Miner&#39;s article:</p><div class=highlight><pre><code class="html language-html" data-lang=html><span class=nt>&lt;ul</span> <span class=na>class=</span><span class=s>&quot;timeline&quot;</span><span class=nt>&gt;</span>
  <span class=nt>&lt;li</span> <span class=na>class=</span><span class=s>&quot;bar&quot;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;a</span> <span class=na>href=</span><span class=s>&quot;http://www.example.com/2007/dec/1/&quot;</span> <span class=na>title=</span><span class=s>&quot;December 1, 2007: 40&quot;</span><span class=nt>&gt;</span>
      <span class=nt>&lt;span</span> <span class=na>class=</span><span class=s>&quot;bar-label&quot;</span><span class=nt>&gt;</span>1<span class=nt>&lt;/span&gt;</span>
      <span class=nt>&lt;span</span> <span class=na>class=</span><span class=s>&quot;count&quot;</span> <span class=na>style=</span><span class=s>&quot;height: 20%&quot;</span><span class=nt>&gt;</span>(40)<span class=nt>&lt;/span&gt;</span>
    <span class=nt>&lt;/a&gt;</span>
  <span class=nt>&lt;/li&gt;</span>
  <span class=cp>&lt;! -- more bars --&gt;</span>
<span class=nt>&lt;/ul&gt;</span>
</code></pre></div><p>You can see the timeline from his original code <a href=http://alistapart.com/d/accessibledata/example-timeline.html>here</a>. To adjust it for flexbox, we simply add the <code>display: flex</code> property to the <strong>.timeline</strong> <code>ul</code> element, which makes it flexbox-enabled. From there we can tell the flexbox to align the child elements horizontally with <code>flex-direction: row</code> and make sure they span evenly between the entire container with <code>justify-content</code>. <code>css .timeline { display: flex; flex-direction: row; justify-content: space-between; }</code> Here&#39;s our new, finished result:<iframe src="//aboutaaron.github.io/flexbox-chart/" width=100% scrolling=no frameborder=0></iframe><small>View a larger example of this chart <a href="//aboutaaron.github.io/flexbox-chart/">here</a></small></p><p>It looks the same, but <strong>resize the browser window</strong> to see <code>flexbox</code> in action. You&#39;ll notice that the bars of the chart adjust their width dynamically to fit inside the container. We didn&#39;t have to write any media queries or use complicated absolute positioning. <em>It just works</em>.</p><p>The code I used for this flexbox chart is <a href=https://github.com/aboutaaron/flexbox-chart>hosted on Github</a>. Poke around and take a look at how I put it together.</p><p>I used this code in the wild for an interactive I built last year that went with CIR&#39;s investigation on telemarketing agencies representing charities in Iowa. <a href=http://cironline.org/reports/one-donation-charity-telemarketer-spawns-more-solicitation-calls-5544#interactive>View the interactive</a> to see this same flexbox technique.</p><h4>Caveats</h4><p>As I said above, <code>flexbox</code> is still in active development and is subject to change. Whenever you use a bleeding edge CSS spec, <strong>make sure you have a fallback</strong>. Use a tool like <a href="http://modernizr.com/">Modernizr</a> to detect if flexbox is supported, and if not, write a <code>.no-flexbox</code> rule in CSS to just float the child elements and display them as inline-blocks. Modernizr will attach the class to the <code>&lt;html&gt;</code> element for you.</p><p>Also, as of this writing, the <code>position</code> declaration doesn&#39;t play very nicely with <code>flexbox</code>. For example, you&#39;ll notice in the HTML above that <code>span.count</code> is a child of <code>li.bar</code> and its height is determined by the data associated inline in the height attribute. Normally, to achieve a bar chart look, you would write some CSS to float <code>.count</code> to the bottom of <code>.bar</code>:</p><div class=highlight><pre><code class="css language-css" data-lang=css><span class=nc>.bar</span> <span class=p>{</span>
  <span class=k>position</span><span class=o>:</span> <span class=k>relative</span><span class=p>;</span>
<span class=p>}</span>

<span class=nc>.bar</span> <span class=nc>.count</span> <span class=p>{</span>
  <span class=k>position</span><span class=o>:</span> <span class=k>absolute</span><span class=p>;</span>
  <span class=k>bottom</span><span class=o>:</span> <span class=m>0</span><span class=p>;</span>
<span class=p>}</span>
</code></pre></div><p>Unfortunately, this will mess up the <code>flexbox</code> dynamic resizing and provide less than ideal results. Furthermore, since you can&#39;t position <code>.count</code> absolutely, all the child elements will float to the top of their parent elements and and create upside-down bar chart:</p><p><img src=/img/upside_down.ee34.png alt="An upside down bart chart."></p><p>One <strong>hacky</strong> way to solve this is to find the heights of the parent and child elements, subtract them from each other, and assign the difference to the <code>margin-top</code> of the child element (<em>using jQuery because laziness</em>):</p><div class=highlight><pre><code class="js language-js" data-lang=js>  <span class=kd>var</span> <span class=nx>$bars</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=s1>&#39;.timeline .bar&#39;</span><span class=p>);</span>

  <span class=nx>$</span><span class=p>.</span><span class=nx>each</span><span class=p>(</span><span class=nx>$bars</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>index</span><span class=p>,</span> <span class=nx>bar</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>var</span> <span class=nx>barHeight</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=nx>bar</span><span class=p>).</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;a&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>(),</span>
        <span class=nx>countHeight</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=nx>bar</span><span class=p>).</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;a .count&#39;</span><span class=p>).</span><span class=nx>height</span><span class=p>();</span>

    <span class=nx>$</span><span class=p>(</span><span class=nx>bar</span><span class=p>).</span><span class=nx>find</span><span class=p>(</span><span class=s1>&#39;.count&#39;</span><span class=p>).</span><span class=nx>css</span><span class=p>(</span><span class=s1>&#39;margin-top&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>barHeight</span> <span class=o>-</span> <span class=nx>countHeight</span><span class=p>));</span>
  <span class=p>});</span>
</code></pre></div><p>This <strong>is not</strong> an elegant solution, but it does solve the problem. In my experience, there isn&#39;t a huge performance hit doing this on a decent array of <code>div</code>s (I tried this on 500+ without lag), but your mileage may vary.</p><h3>Closing Thoughts</h3><p>I want to make it clear that I <em>love d3.js</em>. It&#39;s a powerful tool and I would recommend it to anyone making any kind of interactive visualization for the web. That said, it&#39;s always worth exploring other techniques for creating web content.</p><p>CSS is a clunky technology, but it&#39;s all we have for making things look pretty on the web. Luckily, people are working hard to make it a worthwhile spec and tools like <code>flexbox</code> are just the beginning.</p></section></article><footer class=post-footer><section class=author><h4>Aaron Williams</h4><p>Aaron Williams is a web developer and journalist based in Emeryville, Calif. He currently works for the Center for Investigative Reporting as a news applications developer.</p></section><section class=share><h4>Share this post</h4><a class=icon-twitter href="http://twitter.com/share?text=Accessible Data Visualization with Flexbox&url=/accessible-data-visualization-with-flexbox" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false"><i class="fa fa-twitter"></i></a> <a class=icon-facebook href="https://www.facebook.com/sharer/sharer.php?u=/accessible-data-visualization-with-flexbox" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false"><i class="fa fa-facebook"></i></a> <a class=icon-google-plus href="https://plus.google.com/share?url=/accessible-data-visualization-with-flexbox" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false"><i class="fa fa-google-plus"></i></a></section></footer></div></div><script src=/_bower_components/threejs/build/three.js></script><script src=/_bower_components/tweenjs/src/Tween.js></script><script src=/js/script.99a6.js></script><!-- Google Analytics: change UA-XXXXX-X to be your site's ID. --><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-28341748-1');ga('send','pageview');</script><footer class=site-footer><a class=subscribe href="http://aboutaaron.com/rss/"><i class="fa fa-rss"></i> <span class=tooltip>Subscribe!</span></a><div class=inner><section class=copyright>All content copyright <a href="/">Aaron Williams</a> © 2014 • All rights reserved.</section><!-- <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://ghost.org">Ghost</a></section> --></div></footer></body></html>