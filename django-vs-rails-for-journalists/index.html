<!DOCTYPE html><html class=no-js><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Django to Rails - A selective guide in their differences for data journalists</title><meta name=description content=""><meta name=viewport content="width=device-width, initial-scale=1"><!-- Place favicon.ico and apple-touch-icon(s) in the root directory --><link href=//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css rel=stylesheet><link rel=stylesheet type=text/css href="//fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic|Open+Sans:700,400"><link rel=stylesheet href=/css/main.23ea.css><script src=/js/head-scripts.a52a.js></script></head><body><!--[if lt IE 8]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--><header id=site-head><div class=vertical><div id=site-head-content class=inner><a id=blog-logo href="/"><img src="http://gravatar.com/avatar/821e34ba1be557547dd449463ddf4d24?s=600" alt="Blog Logo"></a><h1 class=blog-title>aboutaaron</h1><h2 class=blog-description>journalist and web developer</h2></div></div></header><div class=frame><div class=bit-50><article class=post><time>06 Sep 2014</time><h1 class=post-title>Django to Rails - A selective guide in their differences for data journalists</h1><section class=post-content><p>A former colleague and great friend of mine, Agustin Armendariz, recently joined the The New York Times to do some amazing investigative data reporting.</p><p>For those who don&#39;t know, he&#39;s a Python guy and the Times is primarily a Ruby shop.</p><p>I started out as a Rails programmer, and though I primarily use Django these days, I still have a lot of love for Ruby and Rails. Knowing this, Agustin emailed me and asked if I could break down some of the differences between the two languages and their frameworks.</p><p>While there are a billion Django Vs. Ruby guides on the Internet, there wasn&#39;t one tailored toward data journalist and news app developers. So what follows is a drive-by walkthrough of the frameworks with many off-the-top explanations of its concepts.</p><p><strong>This isn&#39;t meant to be used in a classroom nor do I consider this a definitive guide.</strong></p><p>It&#39;s a <em>high-level explanation</em> of two frameworks to a friend. Given the interest in news application development these days, I thought I&#39;d publish what I wrote.</p><p>If you&#39;re just starting out as a programmer, this guide probably won&#39;t help and I suggest you explore the tutorials provided by both frameworks:</p><ul><li><a href="https://docs.djangoproject.com/en/1.7/intro/tutorial01/">Official Django Project Tutorial</a><ul><li>Chicago Tribune&#39;s Andy Boyle has a great guide to building news applications with Django. Read it!: <a href="http://www.andymboyle.com/django-tutorials/">Andy Boyle&#39;s Django tutorials</a></li></ul></li><li><a href="http://guides.rubyonrails.org/">Official Ruby on Rails Guides</a><ul><li>Michael Hartl&#39;s Rails tutorial is also excellent: <a href="https://www.railstutorial.org/">Rails Tutorial</a></li></ul></li></ul><p>Enjoy!</p><p>Aaron</p><h2>Rails vs. Django</h2><p>For the most part, Python and Ruby are very similar. They&#39;re <a href=https://en.wikipedia.org/wiki/Type_system#DYNAMIC>dynamically typed languages</a> that are built for all kinds of uses. Python is heavily backed by the science community so tools like numpy, nltk, pandas, fuzzywuzzy, etc. are missing from the Ruby ecosystem. <strong>That really sucks</strong> for data journalist used to working with these libraries.</p><p>That said, what you will gain with Ruby is a language and library ecosystem that evolves and adapts quickly. Ruby is at version 2.0 and Rails at 4.x. Both were adopted fairly quickly. Compare that to Python 3! Also, Rails makes a lot of assumptions on how you want to build web apps and thus makes it super simple to go from <em>some idea</em> to <strong>newsapp.com</strong>.</p><p>I initially gravitated to Ruby/Rails for that very reason. While I love Python (now), Ruby offered gratification much quicker as a novice programmer. So with that, let&#39;s look at an API I wrote to scrape California wildfire data and build an API.</p><h4>Quick notes</h4><h4>Rails 3.x</h4><p>I&#39;m using a fork of Rails called <a href=https://github.com/rails-api/rails-api>Rails-API</a> that removes a lot of the cruft from the default Rails scaffold and helps you build API only applications. Think of it like using a version of Django that had views and tests removed and JSON endpoints for views instead of of HTML templates. I converted this application from a full Rails app to the API only version as an exercise, but you&#39;ll still be able to learn the &quot;Rails&quot; way with this app.</p><p>Also, this was built with Rails 3. Rails 4 is the new hottness. While most of what I did is the same in Rails 4, some shit may be different.</p><h4>MVC vs MTV</h4><p>OK, so some quick semantics. In Django you have Models (your data representation), Templates(what they look like) and Views(where they go) - sometimes called MTV. In Rails you have Models (your data), Views (what they look like) and Controllers (where they go) - often called MVC. Understanding this will make your life a lot easier.</p><h4>Use the getting started</h4><p>Just like Django, the Rails getting started tutorial is pretty solid and will teach you a bunch of staff about the framework and the language. It&#39;s definitely worth your time to explore: http://guides.rubyonrails.org/getting_started.html</p><h4>Branches</h4><p>The code for this app is listed at https://github.com/aboutaaron/fire-scraper</p><p>There&#39;s an <code>api</code> branch and the <code>master</code>. The <code>api</code> branch has the better Rails code in it but doesn&#39;t have the default project scaffold. The <code>master</code> branch has some ugly code but is closer to the default Rails project scaffold. I jump between the two in this walkthrough but feel free to inspect the code base yourself.</p><p>Okay, without further ado, let&#39;s walk through a Rails app.</p><h2>Our App</h2><p><a href=https://github.com/aboutaaron/fire-scraper>Fire-scraper</a> is a Rails app that scrapes wildfire data, stores it in a SQL database and then offers JSON endpoints for users to consume. The endpoints are listed here: http://calfire-api.herokuapp.com/. I then wrote a frontend app to display the info. You can see a crappy version of the frontend here: https://aboutaaron.github.io/fuego/. How does it work?</p><h2>Models</h2><p>So, with a Django project, you have the <code>site &gt; project &gt; app</code> structure. Each app has a <code>model.py</code> with every model definition inside of it and apps are kind of the main event right?</p><p>Well, in Rails, there are no <em>apps</em>. Your models are the main attraction and each model gets a file located in <code>app/models/.rb</code>.</p><p>So looking here https://github.com/aboutaaron/fire-scraper/tree/api/app/models you can see that Counties and Fires, my models, get their own files. And so your foreign keys happen in the appropriate files. In this case, a County <code>:has_many</code> Fires and all Fires <code>:belongs_to</code> a County.</p><p><code>app/models/county.rb</code></p><div class=highlight><pre><code class="rb language-rb" data-lang=rb><span class=k>class</span> <span class=nc>County</span> <span class=o>&lt;</span> <span class=no>ActiveRecord</span><span class=o>::</span><span class=no>Base</span>
  <span class=kp>extend</span> <span class=no>FriendlyId</span>
  <span class=n>friendly_id</span> <span class=ss>:name</span><span class=p>,</span> <span class=ss>use</span><span class=p>:</span> <span class=ss>:slugged</span>
  <span class=n>attr_accessible</span> <span class=ss>:name</span>

  <span class=n>validates</span> <span class=ss>:name</span><span class=p>,</span> <span class=ss>uniqueness</span><span class=p>:</span> <span class=kp>true</span><span class=p>,</span> <span class=ss>presence</span><span class=p>:</span> <span class=kp>true</span>

  <span class=n>has_many</span> <span class=ss>:fires</span>
  <span class=n>accepts_nested_attributes_for</span> <span class=ss>:fires</span>

  <span class=n>geocoded_by</span> <span class=ss>:full_address</span>
  <span class=n>after_validation</span> <span class=ss>:geocode</span>

  <span class=k>def</span> <span class=nf>full_address</span>
    <span class=nb>name</span> <span class=o>+</span> <span class=s2>&quot; County, California, USA&quot;</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div><p><code>app/models/fire.rb</code></p><div class=highlight><pre><code class="rb language-rb" data-lang=rb><span class=k>class</span> <span class=nc>Fire</span> <span class=o>&lt;</span> <span class=no>ActiveRecord</span><span class=o>::</span><span class=no>Base</span>
  <span class=n>attr_accessible</span> <span class=ss>:acreage</span><span class=p>,</span> <span class=ss>:containment</span><span class=p>,</span> <span class=ss>:date</span><span class=p>,</span> <span class=ss>:location</span><span class=p>,</span> <span class=ss>:name</span><span class=p>,</span> <span class=ss>:county_id</span><span class=p>,</span> <span class=ss>:active</span>

  <span class=n>validates</span> <span class=ss>:acreage</span><span class=p>,</span> <span class=ss>:date</span><span class=p>,</span> <span class=ss>:name</span><span class=p>,</span> <span class=ss>:location</span><span class=p>,</span> <span class=ss>:county_id</span><span class=p>,</span> <span class=ss>presence</span><span class=p>:</span> <span class=kp>true</span>

  <span class=n>validates</span> <span class=ss>:location</span><span class=p>,</span> <span class=ss>uniqueness</span><span class=p>:</span> <span class=kp>true</span>

  <span class=n>belongs_to</span> <span class=ss>:county</span>
<span class=k>end</span>
</code></pre></div><p>As you can already tell, this is a strength of Ruby. All you need to add are the <code>has_many :child_model</code> and <code>belongs_to :parent_model</code> attributes in the corresponding files and you have a foreign key relationship. <strong>THIS</strong>, in my opinion, is why people like Rails. It&#39;s almost like you&#39;re describing an app you&#39;re building rather than building one, and yet, when you run the server, there&#39;s your app humming away.</p><h2>URLs</h2><h3>Views/Controllers</h3><p>So in Django, you usually have the <code>views.py</code> that takes a your model and attaches the data to some kind of template. And then you have your <code>urls.py</code> file that handles all the URL routing between the two (when a user hits this url, takes this view and assign the data to this template).</p><p>Well, in Rails the <code>views.py</code> equivalent are your <code>Controller</code> files. Located in <code>app/controllers/</code> these files will move your model data to your templates.</p><p>https://github.com/aboutaaron/fire-scraper/blob/api/app/controllers/counties_controller.rb</p><div class=highlight><pre><code class="rb language-rb" data-lang=rb><span class=k>def</span> <span class=nf>index</span>
  <span class=vi>@counties</span> <span class=o>=</span> <span class=no>County</span><span class=o>.</span><span class=n>all</span>

  <span class=n>respond_to</span> <span class=k>do</span> <span class=o>|</span><span class=nb>format</span><span class=o>|</span>
    <span class=nb>format</span><span class=o>.</span><span class=n>json</span> <span class=p>{</span> <span class=n>render</span> <span class=p>}</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div><p>So here, you can see that the <code>def index</code> method represents the URL path. We&#39;re grabbng all the counties and storing them in the <code>@counties</code> instance variable (instance variables have an @ in front of them and basically act as class level attributes) and then we have a block (HUGE thing in Ruby) to say what format this data should be represented in. So, in the example above, when a user hits the counties index page, I want to return a representation of the data as JSON. If I wanted to return the data as HTML I could&#39;ve also written it like this:</p><div class=highlight><pre><code class="rb language-rb" data-lang=rb><span class=k>def</span> <span class=nf>index</span>
  <span class=vi>@counties</span> <span class=o>=</span> <span class=no>County</span><span class=o>.</span><span class=n>all</span>

  <span class=n>respond_to</span> <span class=k>do</span> <span class=o>|</span><span class=nb>format</span><span class=o>|</span>
    <span class=nb>format</span><span class=o>.</span><span class=n>html</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div><p>You can, of course, have HTML and JSON. See an example of this in the <code>master</code> branch of the repo: https://github.com/aboutaaron/fire-scraper/blob/master/app/controllers/counties_controller.rb</p><p>But the idea is that your have a <strong>PER</strong> model <code>model_name.rb</code> file and a <strong>per</strong> model <code>model_name_controller.rb</code> file. So, we&#39;ve defined your model and relationships and we&#39;ve set up the controller (again, known as a Django View) to route the model info from the database to either JSON, HTML or whatever format we define. How does the controller communicate this information via the URL?</p><h3>Routes</h3><p>Okay, so now we have data moving from the models to a view but how does a user access that data? Well, in Django your <code>urls.py</code> connects your <strong>view</strong> logic to your <strong>template</strong> logic. In Rails, this comes down to the <code>config/routes.rb</code>. See: https://github.com/aboutaaron/fire-scraper/blob/api/config/routes.rb</p><div class=highlight><pre><code class="rb language-rb" data-lang=rb><span class=no>FireScraper</span><span class=o>::</span><span class=no>Application</span><span class=o>.</span><span class=n>routes</span><span class=o>.</span><span class=n>draw</span> <span class=k>do</span>
  <span class=n>resources</span> <span class=ss>:counties</span><span class=p>,</span> <span class=ss>:only</span> <span class=o>=&gt;</span> <span class=o>[</span><span class=ss>:show</span><span class=p>,</span> <span class=ss>:index</span><span class=o>]</span><span class=p>,</span> <span class=ss>defaults</span><span class=p>:</span> <span class=p>{</span> <span class=nb>format</span><span class=p>:</span> <span class=ss>:json</span> <span class=p>}</span>
  <span class=n>resources</span> <span class=ss>:fires</span><span class=p>,</span> <span class=ss>:only</span> <span class=o>=&gt;</span> <span class=o>[</span><span class=ss>:index</span><span class=o>]</span><span class=p>,</span> <span class=ss>defaults</span><span class=p>:</span> <span class=p>{</span> <span class=nb>format</span><span class=p>:</span> <span class=ss>:json</span> <span class=p>}</span>
<span class=k>end</span>
</code></pre></div><p>I won&#39;t go into explaining this logic but basically we&#39;re loading the model resources (fires, counties) and telling <code>routes.rb</code> what controllers to look at. In my case, we&#39;re only looking at the index and show views for counties and only the index controller for fires and we&#39;re defaulting the format to JSON (though I could easily say HTML or whatever). Remember, in our <code>Controller</code>, we defined what template to look at so all routes does is say take a model resource and send it to a controller. See more here: http://guides.rubyonrails.org/routing.html</p><p>Boom our URL is humming. This is why Rails is powerful (and scary). With very little code, you can do a shit ton. That said, this is why Pythonistas tend to hate it because it&#39;s sometimes unclear what&#39;s happening outside of the magic.</p><h2>Templates / Views</h2><p>OK, so models and controllers are defined and we have routes setup to talk to the appropriate controllers. Where do we put our templates? In Rails, templates are called <code>views</code> so we check <code>app/views/</code>. Again, like everything in Rails, the folders and files are on a <strong>per</strong> model basis. Rails uses a file type called ERB which stands for <strong>E</strong> mbedded <strong>R</strong> u <strong>B</strong> y. So when Rails sees <code>index.html.erb</code>, it knows it can add Ruby data and objects to the document. Typically your model&#39;s views (or templates in Django parlance) will have a index.html.erb (think a list view in Django) and a show.html.erb (Think a detail view). So one shows all your models and the other shows what happens you click on a specific instance of a model. See: https://github.com/aboutaaron/fire-scraper/blob/master/app/views/counties/show.html.erb</p><p><code>/counties/show.html.erb</code></p><div class=highlight><pre><code class="erb language-erb" data-lang=erb><span class=x>&lt;!-- truncated output --&gt;</span>
<span class=x>&lt;h2&gt;</span><span class=cp>&lt;%=</span> <span class=vi>@county</span><span class=o>.</span><span class=n>name</span> <span class=cp>%&gt;</span><span class=x> County&lt;/h2&gt;</span>
<span class=x>&lt;h3&gt;</span><span class=cp>&lt;%=</span> <span class=vi>@county</span><span class=o>.</span><span class=n>fires</span><span class=o>.</span><span class=n>count</span> <span class=cp>%&gt;</span><span class=x> fires | </span><span class=cp>&lt;%=</span> <span class=n>total_acres_burned</span> <span class=cp>%&gt;</span><span class=x> acres burned since </span><span class=cp>&lt;%=</span> <span class=vi>@county</span><span class=o>.</span><span class=n>fires</span><span class=o>.</span><span class=n>last</span><span class=o>.</span><span class=n>date</span> <span class=cp>%&gt;</span><span class=x>&lt;/h3&gt;</span>
<span class=x>&lt;table id=&quot;show-table&quot; class=&quot;eight columns&quot;&gt;</span>
<span class=x>  &lt;thead&gt;</span>
<span class=x>    &lt;tr&gt;</span>
<span class=x>      &lt;th&gt;Name&lt;/th&gt;</span>
<span class=x>      &lt;th&gt;Acres burned&lt;/th&gt;</span>
<span class=x>      &lt;th&gt;Date started&lt;/th&gt;</span>
<span class=x>      &lt;th&gt;Containment&lt;/th&gt;</span>
<span class=x>    &lt;/tr&gt;</span>
<span class=x>  &lt;/thead&gt;</span>
<span class=x>  &lt;tbody&gt;</span>
<span class=x>    </span><span class=cp>&lt;%</span> <span class=vi>@county</span><span class=o>.</span><span class=n>fires</span><span class=o>.</span><span class=n>each</span> <span class=k>do</span> <span class=o>|</span><span class=n>fire</span><span class=o>|</span> <span class=cp>%&gt;</span><span class=x></span>
<span class=x>      &lt;tr&gt;</span>
<span class=x>        &lt;td&gt;</span><span class=cp>&lt;%=</span> <span class=n>fire</span><span class=o>.</span><span class=n>name</span> <span class=cp>%&gt;</span><span class=x>&lt;/td&gt;</span>
<span class=x>        &lt;td&gt;</span><span class=cp>&lt;%=</span> <span class=n>number_with_delimiter</span><span class=p>(</span><span class=n>fire</span><span class=o>.</span><span class=n>acreage</span><span class=p>)</span> <span class=cp>%&gt;</span><span class=x>&lt;/td&gt;</span>
<span class=x>        &lt;td&gt;</span><span class=cp>&lt;%=</span> <span class=n>fire</span><span class=o>.</span><span class=n>date</span> <span class=cp>%&gt;</span><span class=x>&lt;/td&gt;</span>
<span class=x>        &lt;td&gt;</span><span class=cp>&lt;%=</span> <span class=n>fire</span><span class=o>.</span><span class=n>containment</span> <span class=cp>%&gt;</span><span class=x>&lt;/td&gt;</span>
<span class=x>      &lt;/tr&gt;</span>
<span class=x>    </span><span class=cp>&lt;%</span> <span class=k>end</span> <span class=cp>%&gt;</span><span class=x></span>
<span class=x>  &lt;/tbody&gt;</span>
<span class=x>&lt;/table&gt;</span>
</code></pre></div><p>Hopefully this .erb makes sense. I&#39;m grabbing this instance of the county and using ERB template tags <code>&lt;%= %&gt;</code> to display info from my model in the HTML. This should feel familiar to the Django dev used to using <code>{ { } }</code> to insert data into templates</p><h2>Fab/Management Commands</h2><p>OK so finally, you probably want to know where you can do the <strong>data</strong> part of the app building. By now, I hope it makes sense how Rails and Django are similar and different. You should more or less get how models look, what controllers do and how all of that communicates with your views. But let&#39;s get to the fun part.</p><p>So for my app, I had to write a scraper to collect wildfire information from CAL Fire. I used <a href="http://docs.seattlerb.org/mechanize/">Mechanize</a> and <a href="http://nokogiri.org/">Nokogiri</a> (awesome libraries by the way) to grab the information I want it and store it in a database. How&#39;d I do that and where did it go?</p><h3>Rake</h3><p>So for Rails, rather than have management commands or fab tasks, everything happens with <a href=https://github.com/jimweirich/rake>Rake</a>. Rake, which stands for Ruby Make, allows you to setup tasks to run either view the command line or via CRON. That&#39;s entirely up to you. Your tasks live in <code>lib/tasks/</code>. The <code>lib</code> directory is basically where you store your Ruby code or stuff that isn&#39;t super Rails specific. Think of this place of where you might keep a <code>load.rb</code> file. So I have a <code>populate.rb</code> that does my scraping. Here it is:</p><div class=highlight><pre><code class="rb language-rb" data-lang=rb><span class=nb>require</span> <span class=s1>&#39;mechanize&#39;</span>

<span class=n>namespace</span> <span class=ss>:app</span> <span class=k>do</span>
  <span class=n>desc</span> <span class=s1>&#39;import fire information from Cal Fire&#39;</span>
  <span class=n>task</span> <span class=ss>:import</span> <span class=o>=&gt;</span> <span class=ss>:environment</span> <span class=k>do</span>
    <span class=n>a</span> <span class=o>=</span> <span class=no>Mechanize</span><span class=o>.</span><span class=n>new</span>
    <span class=n>a</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;http://cdfdata.fire.ca.gov/incidents/incidents_current?sort=incident_priority&amp;pc=all&#39;</span><span class=p>)</span>

    <span class=c1># .incident_table contains fire. Drop the first table since it&#39;s empty</span>
    <span class=n>a</span><span class=o>.</span><span class=n>page</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&quot;.incident_table&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span><span class=o>.</span><span class=n>each</span> <span class=k>do</span> <span class=o>|</span><span class=n>incident</span><span class=o>|</span>
      <span class=c1># Store metadata</span>
      <span class=n>metadata</span> <span class=o>=</span> <span class=n>incident</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&quot;.odd:nth-child(6) td:nth-child(2)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span>

      <span class=c1># Store the name of the county and then create it if it doesn&#39;t exist</span>
      <span class=vi>@county</span> <span class=o>=</span> <span class=n>incident</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&quot;:nth-child(3) td:nth-child(2)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=sr>/\b\sCounty|Counties/</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=sr>/\W$/</span><span class=p>,</span><span class=s2>&quot;&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=sr>/\s$/</span><span class=p>,</span><span class=s2>&quot;&quot;</span><span class=p>)</span>
      <span class=no>County</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=ss>:name</span> <span class=o>=&gt;</span> <span class=vi>@county</span><span class=p>)</span><span class=o>.</span><span class=n>first_or_create</span>

      <span class=c1># Store the fire name and then create it if it doesn&#39;t exist. Update if it does.</span>
      <span class=vi>@fire</span> <span class=o>=</span> <span class=n>incident</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&quot;.odd:nth-child(2) td:nth-child(2)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=sr>/\W$/</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
      <span class=n>fire</span> <span class=o>=</span> <span class=no>Fire</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=ss>:name</span> <span class=o>=&gt;</span> <span class=vi>@fire</span><span class=p>)</span><span class=o>.</span><span class=n>first_or_initialize</span>
      <span class=n>fire</span><span class=o>.</span><span class=n>update_attributes</span><span class=p>(</span>
        <span class=ss>:date</span> <span class=o>=&gt;</span> <span class=no>Chronic</span><span class=o>::</span><span class=n>parse</span><span class=p>(</span><span class=n>incident</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&quot;.even:nth-child(7) td:nth-child(2) , .even:nth-child(8) td:nth-child(2)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=p>),</span>
        <span class=ss>:location</span> <span class=o>=&gt;</span> <span class=n>incident</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s2>&quot;.odd:nth-child(4) td:nth-child(2)&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=p>,</span>
        <span class=ss>:acreage</span> <span class=o>=&gt;</span> <span class=n>metadata</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=sr>/^[,0-9]*/</span><span class=p>)</span><span class=o>.</span><span class=n>to_s</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>to_i</span><span class=p>,</span>
        <span class=ss>:county_id</span> <span class=o>=&gt;</span> <span class=no>County</span><span class=o>.</span><span class=n>find_by_name</span><span class=p>(</span><span class=vi>@county</span><span class=p>)</span><span class=o>.</span><span class=n>id</span><span class=p>,</span>
        <span class=ss>:containment</span> <span class=o>=&gt;</span> <span class=n>metadata</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=sr>/\d*%/</span><span class=p>)</span><span class=o>.</span><span class=n>to_s</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>to_i</span><span class=p>,</span>
        <span class=ss>:active</span> <span class=o>=&gt;</span> <span class=p>(</span><span class=n>metadata</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=sr>/\d*%/</span><span class=p>)</span><span class=o>.</span><span class=n>to_s</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>to_i</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=o>&amp;&amp;</span> <span class=n>metadata</span><span class=o>.</span><span class=n>match</span><span class=p>(</span><span class=sr>/\d*%/</span><span class=p>)</span><span class=o>.</span><span class=n>to_s</span><span class=o>.</span><span class=n>gsub</span><span class=p>(</span><span class=s1>&#39;%&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>to_i</span> <span class=o>&lt;</span> <span class=mi>100</span> <span class=o>?</span> <span class=kp>true</span> <span class=p>:</span> <span class=kp>false</span><span class=p>)</span>
      <span class=p>)</span>
    <span class=k>end</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div><p>I won&#39;t do a huge primer on Rake, but basically I&#39;ve named spaced this task to <code>:app</code>. This is just for organization. I could also have a <code>:deploy</code> namespace if I wanted stuff just for launch. I then describe that the tasks does and in the <code>tasks</code> method I give my task a name like <code>:import</code> and use the rocket operator to have Rake include my app&#39;s <code>:environment</code>. This is what gives me access to my models.</p><p>From there, it&#39;s just a scraper that crawls the page and does a <code>Model.objects.get_or_create</code> in Django parlance except I&#39;m using the more powerful Rails method <code>Model.update_attributes</code>which either creates the model or updates an existing one (Rails also has <code>get_or_create</code>. Unfortunately Django doesn&#39;t have a <code>get_or_update</code> ).</p><p>To call my rake task, I&#39;d run this in Terminal: <code>bash $ rake app:import</code></p><p>And from there my scraped information goes into the database!</p><h2>Some other gotchas</h2><p>Here&#39;s some other stuff to consider with Rails. In no particular order:</p><ul><li><strong>Database migrations are the default</strong>: Hate using South in Django? Well, too fucking bad because Rails has database migrations be default. They&#39;re actually really helpful, but Rails devs will get really pissed at your if you don&#39;t have some kind of migration history. So try using it a bit before you do the blowup-and-repopulate technique</li><li><strong>Study Bundler</strong>: Rails uses Bundler to handle app dependencies and what not. There&#39;s a lot you can do with it and the sooner you learn how to package your dependencies by environment (These are my DEV dependencies, these are for STAGING, and these are for PRODUCTION) the sooner you&#39;ll be a better Rails dev.</li><li><strong>Learn the language</strong>: Like Django, you don&#39;t necessarily need to know the language Rails is written in to do some damage. That said, knowing Python certainly makes you a better Django dev. The same goes for Rails and Ruby. Learn about blocks, metaprogramming, hash rockets and string interpolation. These are awesome Ruby features that&#39;ll make you understand Rails a little better.</li></ul><h2>Wrap up</h2><p>So hopefully this horribly long and horribly written walkthough illuminated some of the idiosyncrasies of Rails to the Django developer. While you lose some of the data manipulation libraries, you gain a lot in fast app scaffolding and deployment. And considering that data powerhouses like ProPublica and NYT use Ruby, I imagine they&#39;ve found (or built) the data libs you&#39;ll need to get your job done. While Python is great, don&#39;t sleep on Ruby and Rails as they&#39;ve time and time again proved to be great tools for developers.</p></section></article><footer class=post-footer><section class=author><h4>Aaron Williams</h4><p>Aaron Williams is a web developer and journalist based in Emeryville, Calif. He currently works for the Center for Investigative Reporting as a news applications developer.</p></section><section class=share><h4>Share this post</h4><a class=icon-twitter href="http://twitter.com/share?text=Django to Rails - A selective guide in their differences for data journalists&url=/django-vs-rails-for-journalists" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false"><i class="fa fa-twitter"></i></a> <a class=icon-facebook href="https://www.facebook.com/sharer/sharer.php?u=/django-vs-rails-for-journalists" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false"><i class="fa fa-facebook"></i></a> <a class=icon-google-plus href="https://plus.google.com/share?url=/django-vs-rails-for-journalists" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false"><i class="fa fa-google-plus"></i></a></section></footer></div></div><script src=/_bower_components/threejs/build/three.js></script><script src=/_bower_components/tweenjs/src/Tween.js></script><script src=/js/script.99a6.js></script><!-- Google Analytics: change UA-XXXXX-X to be your site's ID. --><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-28341748-1');ga('send','pageview');</script><footer class=site-footer><a class=subscribe href="http://aboutaaron.com/rss/"><i class="fa fa-rss"></i> <span class=tooltip>Subscribe!</span></a><div class=inner><section class=copyright>All content copyright <a href="/">Aaron Williams</a> © 2014 • All rights reserved.</section><!-- <section class="poweredby">Proudly published with <a class="icon-ghost" href="http://ghost.org">Ghost</a></section> --></div></footer></body></html>